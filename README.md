# Linux-Camera
一、项目功能  
一个简易的linux相机项目，涉及V4L2框架的应用，获取OV5640摄像头的数据，摄像头数据在LCD屏上的显示，触摸交互，多线程操作，采用双向链表方式对照片进行存储。
-
二、项目核心功能总结  
1.摄像头驱动（OV5640）  
> 1. 传感器驱动（ov5640.c）

   > 对ov5640硬件初始化，probe函数中配置引脚，时钟，复位这些，支持分辨率的设置，以及I2C通信配置

> 2. CSI接口驱动（mx6s_capture.c）

   > 实现V4L2标准接口，管理采集缓冲区，初始化CSI硬件（时钟，DMA，中断），实现了V4L2的整体框架
2.从摄像头获取一帧图像（V4L2框架）
> 主要的就是v4l2_camera_init初始化摄像头设备，然后就是v4l2_camera_set_format配置摄像头的采集格式（分辨率、像素格式等），并初始化缓冲队列）。
3.LCD上实时显示摄像头采集的JPEG数据
> 第二步使用V4L2框架从摄像头中获取到一帧图像，格式为JPEG，如果要在LCD屏幕上显示，则需要将其解压缩为RGB数据。解压缩使用libjpeg库来完成。
> 得到了RGB888格式后的文件后，就可以直接将数据写入到framebuffer中显示在LCD屏幕上  
4.触摸屏驱动（gt911）  
5.主线程实时显示摄像头数据，副线程检测触摸屏是否有合法输入（多线程）  
> 副线程检测触摸屏是否有合法输入  

  > 有合法输入之后，加锁，改变全局变量（触摸点的x和y坐标），解锁  

> 主线程实时显示摄像头数据  

  > 主线程显示摄像头数据的同时，检测全局变量触摸点坐标是否有改变，如果触摸的x和y坐标符合拍照，则将此时的一帧图像保存在本地，如果触摸的x和y坐标符合查看相册则执行查看本地相册的一个功能  

> 两个线程通过互斥锁完成同步  

  > 当多个线程需要操作同一份共享资源的时候，互斥锁会强制同一时间只能有一个线程进入临界区（操作共享资源的代码段），其他进程需要等待释放后才能进入
6.tslib库实现操控触摸屏
> 通过触摸屏幕，读取我们触摸的位置来判断我们的操作是拍照还是查看相册  
7.图片的存储（双向链表）  
> 核心就是通过每个节点的pre和next指针实现双向遍历和快速增删操作



